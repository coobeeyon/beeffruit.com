---
import Base from "../../layouts/Base.astro";
import Header from "../../components/Header.astro";
import Footer from "../../components/Footer.astro";
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const posts = await getCollection('articles');
  return posts.map((p) => ({ params: { slug: p.slug }, props: { post: p } }));
}

const { post } = Astro.props;
const { data } = post;
const { Content } = await post.render();
const title = `${data.title} — BeefFruit`;
const desc = data.description ?? 'BeefFruit article';
const url = `https://beeffruit.com/articles/${post.slug}`;
const structuredData = {
  '@context': 'https://schema.org',
  '@type': 'Article',
  headline: data.title,
  datePublished: data.pubDate?.toISOString?.() ?? '',
  author: { '@type': 'Organization', name: 'BeefFruit' },
  mainEntityOfPage: url
};
---

<Base {title} description={desc} canonicalUrl={url} structuredData={structuredData}>
  <Fragment slot="header"><Header /></Fragment>
  
  <article class="max-w-4xl mx-auto">
    <!-- Fake urgency banner -->
    <div class="mb-6 p-3 rounded-lg animate-gradient text-black font-bold text-center">
      ⚡ TRENDING NOW • {Math.floor(Math.random() * 9999) + 1000} READING THIS ARTICLE
    </div>
    
    <h1 class="mb-4 text-4xl md:text-5xl font-black glitch-text">{data.title}</h1>
    
    <!-- Fake metrics bar -->
    <div class="flex flex-wrap gap-4 mb-6 text-sm">
      <span class="text-brand-yellow font-bold">🔥 {Math.floor(Math.random() * 999999) + 10000} views</span>
      <span class="text-brand-green">👍 {Math.floor(Math.random() * 9999) + 100}</span>
      <span class="text-brand-red">👎 {Math.floor(Math.random() * 999) + 10}</span>
      <span class="text-gray-400">{new Date(data.pubDate).toLocaleDateString?.() ?? ''}</span>
      <span class="text-brand-pink font-bold blink">🔴 LIVE</span>
    </div>
    
    <div class="mt-8 prose prose-invert prose-lg max-w-none">
      <Content />
    </div>
    
    <!-- Engagement section -->
    <div class="mt-12 p-6 rounded-xl bg-gradient-to-br from-brand-pink/10 to-brand-yellow/10 border border-white/20">
      <h3 class="text-xl font-bold mb-4">DID THIS BLOW YOUR MIND?</h3>
      <div class="flex flex-wrap gap-3">
        <button class="px-4 py-2 rounded-lg bg-brand-pink text-white font-bold hover:scale-110 transition">🤯 YES</button>
        <button class="px-4 py-2 rounded-lg bg-brand-yellow text-black font-bold hover:scale-110 transition">🔥 ABSOLUTELY</button>
        <button class="px-4 py-2 rounded-lg bg-brand-green text-black font-bold hover:scale-110 transition">🚀 TRANSCENDED</button>
        <button class="px-4 py-2 rounded-lg bg-brand-blue text-white font-bold hover:scale-110 transition">🎆 HELP</button>
      </div>
    </div>
    
    <!-- Share chaos -->
    <div class="mt-8 text-center">
      <p class="text-lg font-bold mb-4">SHARE THE CHAOS:</p>
      <div class="flex justify-center gap-4 text-2xl">
        <button class="hover:scale-125 transition" title="Copy link">🔗</button>
        <button class="hover:scale-125 transition" title="Share to Twitter">🐦</button>
        <button class="hover:scale-125 transition" title="Share to Reddit">🤖</button>
        <button class="hover:scale-125 transition" title="Email to enemy">✉️</button>
        <button class="hover:scale-125 transition" title="Print and eat">🖨️</button>
      </div>
    </div>
    
    <!-- Related chaos -->
    <div class="mt-12 p-6 rounded-xl bg-white/5">
      <h3 class="text-xl font-bold mb-4 rainbow-text">MORE UNHINGED CONTENT</h3>
      <div class="grid gap-3">
        <a href="/articles" class="block p-3 rounded-lg bg-white/5 hover:bg-white/10 transition">
          <span class="text-brand-yellow">→</span> Why Mangoes Are Cancelled
        </a>
        <a href="/articles" class="block p-3 rounded-lg bg-white/5 hover:bg-white/10 transition">
          <span class="text-brand-pink">→</span> {Math.floor(Math.random() * 27) + 3} Fruits That Know Your Location
        </a>
        <a href="/quizzes" class="block p-3 rounded-lg bg-white/5 hover:bg-white/10 transition">
          <span class="text-brand-green">→</span> QUIZ: Which Chaotic Food Are You?
        </a>
      </div>
    </div>
  </article>
  
  <Fragment slot="footer"><Footer /></Fragment>
</Base>

<style>
  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
  }
  .blink { animation: blink 1s infinite; }
</style>


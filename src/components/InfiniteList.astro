---
const title = Astro.props?.title ?? 'Trending Weirdness';
---
<section class="py-8">
  <h2 class="text-2xl md:text-3xl font-bold mb-4">{title}</h2>
  <div id="bf-feed" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4"></div>
  <button id="bf-more" class="mt-6 w-full rounded-lg bg-brand-pink/20 text-brand-pink hover:bg-brand-pink/30 py-3 font-semibold">More oddities</button>
</section>

<script>
  const FEED_URL = '/data/items.json';
  let all = [];
  let idx = 0;
  const batch = 12;

  async function load() {
    if (all.length === 0) {
      try {
        const res = await fetch(FEED_URL);
        all = await res.json();
      } catch (err) {
        console.error('Failed to load feed', err);
        return;
      }
    }
    const container = document.getElementById('bf-feed');
    const slice = all.slice(idx, idx + batch);
    idx += slice.length;
    for (const item of slice) {
      const card = document.createElement('article');
      card.className = 'rounded-xl bg-white/5 border border-white/10 p-4 hover:bg-white/10 transition';
      card.innerHTML = `
        <h3 class="font-bold text-lg mb-2">${item.title}</h3>
        <p class="text-sm text-gray-300">${item.blurb}</p>
        <div class="mt-3 text-3xl">${item.emoji ?? ''}</div>
      `;
      container.appendChild(card);
    }
  }

  document.getElementById('bf-more')?.addEventListener('click', load);
  load();
</script>

